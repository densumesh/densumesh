---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

const posts = await getCollection('blog');
const sortedPosts = posts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<Layout title="Blog - Dens Sumesh">
  <section class="mb-6 p-4 border border-zinc-700 rounded">
    <h1 class="text-xl font-normal mb-2">Blog</h1>
    <p>Thoughts on engineering, AI, and building distributed systems.</p>
  </section>

  <section class="mb-6 p-4 border border-zinc-700 rounded">
    {sortedPosts.length === 0 ? (
      <p>No blog posts yet. Check back soon!</p>
    ) : (
      <ul class="space-y-4">
        {sortedPosts.map((post) => (
          <li class="p-4 border border-zinc-700 rounded">
            <h3 class="text-lg font-normal mb-2">
              <a href={`/blog/${post.slug}`} class="text-blue-400 hover:underline">{post.data.title}</a>
            </h3>
            <div class="text-zinc-500 text-sm mb-2">
              {post.data.pubDate.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
              })}
              {post.data.tags.length > 0 && (
                <span> â€¢ {post.data.tags.join(', ')}</span>
              )}
            </div>
            <p>{post.data.description}</p>
          </li>
        ))}
      </ul>
    )}
  </section>

  <!-- External Blog Posts -->
  <section class="section">
    <h2>External Posts</h2>
    <ul>
      <li>
        <a href="https://trieve.ai/accurate-hallucination-detection-with-ner" class="external-link">
          Accurate Hallucination Detection with NER
        </a>
      </li>
      <li>
        <a href="https://trieve.ai/building-blazingly-fast-typo-correction-in-rust" class="external-link">
          Building Blazingly Fast Typo Correction in Rust
        </a>
      </li>
    </ul>
  </section>
</Layout>
